<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="stylesheet" type="text/css" href="jquery/jquery.mobile-1.4.5.css" />
    <link rel="stylesheet" type="text/css" href="css/set1.css" />
    <title>Jobs</title>

</head>
<body>
    <div data-role="page" id="job" data-title="Job" data-url="job">
        <!-- /header-->
        <div data-role="header" data-position="fixed" style="background-color:#0065B3;color:white;">
            <h1 id="span1">Jobs</h1>
        </div>

        <!-- /body-->
        <div data-role="content" style="background-color:white; align-content:center;">
            <table style="border:1px solid grey;font-size:13px;" width="100%" id="tablaJob"></table>
        </div>

        <!-- /footer -->
        <div data-role="footer" data-position="fixed" data-tap-toggle="false" style="background-color:#FFFFFF;color:#a1a1a9;vertical-align:middle;">
            <table cellpadding=0 cellspacing=0 style="border: 1px solid #F2F2F2;width:100%;">
                <tr>
                    <td class="ihome" style="border: none;font-size:0.7em;font-weight: normal;padding-top:5px">
                        <center>
                            <img src="images/home1.png" /><br>
                            <label style="color:grey">Home</label>
                        </center>
                    </td>
                    <td class="ijobs" style="border: none;font-size:0.7em;font-weight: normal;padding-top:5px">
                        <center>
                            <img src="images/jobs1.png" /><br>
                            <label style="color:grey">Jobs</label>
                        </center>
                    </td>
                    <td class="itrip" style="border: none;font-size:0.7em;font-weight: normal;padding-top:5px">
                        <center>
                            <img src="images/trip1.png" /><br>
                            <label style="color:grey">Trips</label>
                        </center>
                    </td>
                    <td class="iprofile" style="border: none;font-size:0.7em;font-weight: normal;padding-top:5px">
                        <center>
                            <img src="images/profile1.png" /><br>
                            <label style="color:grey">Profile</label>
                        </center>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="scripts/platformOverrides.js"></script>
    <script type="text/javascript" src="scripts/index.js"></script>
    <script type="text/javascript" src="scripts/PushNotification.js"></script>
    <script type="text/javascript" src="jquery/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="jquery/jquery.mobile-1.4.5.js"></script>
    <script type="text/javascript" src="scripts/encodedecode.js"></script>

    <script type="text/javascript">
        //****************************************
        function irHome(idjob) {
            window.location.href = 'home.html?idjob=' + idjob;
        }
        //****************************************
        $(document).ready(function () {
            //****************************************
            $('.ihome').click(function () {
                window.location.href = 'home.html?idjob=-1';
            });
            $(".ijobs").click(function () {
                window.location.href = 'jobs.html';
            });
            $(".itrip").click(function () {
                window.location.href = 'trip.html';
            });
            $(".iprofile").click(function () {
                window.location.href = 'profile.html';
            });
            //**************************************
            var input =
                {
                    CodCompany: window.localStorage["CodeCompany"],
                    IdVendor: window.localStorage["IdVendor"]
                };
            //**************************************
            $.ajax({
                cache: true,
                url: "https://services.chancesrmis.com/wcfchancesR/Jobs.svc/ListJobs",
                async: true,
                crossDomain: true,
                type: "POST",
                data: JSON.stringify(input),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("Authorization", "Basic " + Base64.encode("jcJizIJh4EH/e4CBrJFW+A==" + ":" + "d6jlUv9AGSgd219JJvPShA=="));
                    xhr.setRequestHeader("X-Mobile", "false");
                    $('#loader').show();
                },
                error: function (xhr, textStatus, err) {
                    var mensaje = "readyState: " + xhr.readyState + "\n";
                    mensaje = mensaje + "responseText: " + xhr.responseText + "\n";
                    mensaje = mensaje + "status: " + xhr.status + "\n";
                    mensaje = mensaje + "text status: " + textStatus + "\n";
                    mensaje = mensaje + "error: " + err + "\n";
                    $('#loader').hide();
                    navigator.notification.alert(mensaje, function () { }, "ChancesR Error");
                },
                success: function (lstObj) {

                    //*****************************

                    //*****************************
                    if (lstObj.ListJobsResult.length > 0) {
                        //*****************************
                        for (var i = 0; i < lstObj.ListJobsResult.length; i++) {
                            var nombrejob = lstObj.ListJobsResult[i].NameCompletoJob;
                            var idjob = lstObj.ListJobsResult[i].IdJob;
                            $("#tablaJob").append('<tr><td><a href="#" onclick="irHome(idjob=' + idjob + ')">' + nombrejob + '</a></td></tr>');

                        }
                        //*****************************
                        window.location.href = '#verification';
                        //*****************************
                    } else {
                        //*****************************
                        navigator.notification.alert('Federal ID no found', function () { }, "ChancesR Validation");
                        //*****************************
                    }
                },
                complete: function () {
                    $('#loader').hide();
                }
            });
            //***************************************
        });
    </script>
</body>
</html>
